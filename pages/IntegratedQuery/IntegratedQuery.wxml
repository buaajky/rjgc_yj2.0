<!--pages/IntegratedQuery/IntegratedQuery.wxml-->
<view>
  <view class="section">  
    <picker mode="date" value="{{date}}" start="{{start}}" end="{{end}}" field="day" bindchange="bindDateChange" class="time_picker">  
      <view class="picker">  
        查询日期: {{search_date}}  
      </view>  
    </picker> 
    <button hidden="{{compare_show}}" class="button_compare_ready" bindtap="compare_ready">方案对比</button>
    <button hidden="{{!compare_show}}" class="button_compare_cancel" bindtap="compare_cancel">取消选择</button>
    <button hidden="{{!compare_show}}" class="button_compare_do" bindtap="compare_do">对比</button>
  </view>
</view>

<view class="divview"></view>

<l-segment bind:linchange="changeTabs" l-tab-image-class="tab-image" l-class="segment-view"   
               l-active-class="segment-active" activeKey="one">
        <l-segment-item key="one" slot="one">
          <view class="segment-item-text" style="width: 370rpx; height: 70rpx; display: block; box-sizing: border-box" bindtap="sort_price_up">价格升序</view>
        </l-segment-item>

        <l-segment-item key="two" slot="two">
          <view class="segment-item-text" style="width: 364rpx; height: 74rpx; display: block; box-sizing: border-box" bindtap="sort_price_down">价格降序</view>
        </l-segment-item>

</l-segment>  

<l-tabs bind:linchange="changeTabs" animated="true" l-content-class="tab-item-text" active-key="{{search_type}}">
  <l-tabpanel tab="飞机" key="one" slot="one" >
    <view class="list" wx:if="{{get_data_air}}">
      <block wx:for="{{airplaneList}}" wx:key="list" wx:for-item="item">
        <view class="list_item">
          <view class="img">

            <icon wx:if="{{item.selected && compare_show}}" type="success" color="#3963bc" bindtap="selectList_airplane" data-index="{{index}}"/>
            <icon wx:elif="{{compare_show}}" type="circle" bindtap="selectList_airplane" data-index="{{index}}"/>

            <image src="/images/{{item.airline}}.jpg"  mode="widthFix"/>
          </view>
          <view class="info" bindtap="navigate2air" data-index="{{item.id}}">
            <view class="number_and_price">
              <view class="number">{{item.flightno}}</view>
              <view class="price" wx:if="{{item.minprice != 0}}">￥{{item.minprice}}起</view>
              <view class="price" wx:else>暂无价格信息</view>
            </view>
        
            <view class="date_and_city">
              <view class="date">{{item.departdate}}</view>
              <view class="city">{{item.city}} —— {{item.endcity}}</view>
            </view>
            <view class="times" style="width: 462rpx; height: 52rpx; display: flex; box-sizing: border-box">
              <view class="time_left">{{item.departtime}}</view>
              <image src="/images/light_arrow.png" class="arrow"></image>
              <view class="time_right">{{item.arrivaltime}}</view>
            </view>

            <view class="times">
              <l-tag plain="{{true}}" class="airport_left" size="mini">{{item.departport}}</l-tag>
              <l-tag plain="{{true}}" class="airport_right" size="mini">{{item.arrivalport}}</l-tag>
            </view>
        
            <view class="num"></view>
        
          </view>
          <view class="clear"></view>
        </view>
      </block>
    </view>
    <view wx:else class="no_air">{{result_null_air}}</view>
  </l-tabpanel>

  <l-tabpanel tab="火车" key="two" slot="two">
    <view class="list" wx:if="{{get_data_train}}">
      <block wx:for="{{trainList}}" wx:key="list" wx:for-item="item">
        <view class="list_item">
          <view class="img">

            <icon wx:if="{{item.selected && compare_show}}" type="success" color="#3963bc" bindtap="selectList_train" data-index="{{index}}"/>
            <icon wx:elif="{{compare_show}}" type="circle" bindtap="selectList_train" data-index="{{index}}"/>

            <image src="/images/zt.jpg"  mode="widthFix"/>
          </view>
          <view class="info" bindtap="navigate2train" data-index="{{item.id}}">
            <view class="number_and_price">
              <view class="number">{{item.trainno}}</view>
              <view class="price" wx:if="{{item.train_price != 0}}">￥{{item.train_price}}起</view>
              <view class="price" wx:else>暂无价格信息</view>
            </view>
        
            <view class="date_and_city">
              <view class="date">{{item.departdate}}</view>
              <!-- <view class="city">{{item.train_city_start}} —— {{item.train_city_end}}</view> -->
            </view>
            <view class="times" style="width: 462rpx; height: 52rpx; display: flex; box-sizing: border-box">
              <view class="time_left">{{item.departtime}}</view>
              <image src="/images/light_arrow.png" class="arrow"></image>
              <view class="time_right">{{item.arrivaltime}}</view>
            </view>

            <view class="times">
              <l-tag plain="{{true}}" class="airport_left" size="mini">{{item.station}}</l-tag>
              <l-tag plain="{{true}}" class="airport_right" size="mini">{{item.endstation}}</l-tag>
            </view>
        
            <view class="num"></view>
        
          </view>
          <view class="clear"></view>
        </view>
      </block>
    </view>
    <view wx:else class="no_air">{{result_null_train}}</view>
  </l-tabpanel>

  <l-tabpanel tab="换乘方案" key="three" slot="three">
    <view class="list" wx:if="{{get_data_transfer}}">
      <block wx:for="{{transferList}}" wx:key="list" wx:for-item="item">

        <view class="icon_transfer">
          <icon wx:if="{{item.selected && compare_show}}" type="success" color="#3963bc" bindtap="selectList_transfer" data-index="{{index}}"/>
          <icon wx:elif="{{compare_show}}" type="circle" bindtap="selectList_transfer" data-index="{{index}}"/>
        </view>
        

        <view class="list_item_transfer" bindtap="navigate2transfer" data-index1="{{item.t1_id}}" data-index2="{{item.t2_id}}" data-type1="{{item.t1_type}}" data-type2="{{item.t2_type}}">

          <view class="times">
            <view class="info_2">
              <image src="{{item.t1_type=='飞机'?'/images/flight_icon.png':'/images/railway_icon.png'}}" class="air_and_train_icon"></image>
            </view>
            <view class="info_3">
              <view class="number_transfer">{{item.t1_number}}</view>
            </view>
            <view class="info_3">
              <view class="number_transfer">{{item.t2_number}}</view>
            </view>
            <view class="info_2">
              <image src="{{item.t2_type=='飞机'?'/images/flight_icon.png':'/images/railway_icon.png'}}" class="air_and_train_icon"></image>
            </view>
          </view>

          <view class="icons">
            <view class="info_2">
              <view class="transfer_time">{{item.t1_time_start}}</view>
            </view>
            <view class="info_1">
              <image src="/images/light_arrow.png" class="arrow_two"></image>
            </view>
            <view class="info_4">
              <l-tag plain="{{true}}" size="mini">换乘{{item.transfer_time}}</l-tag>
            </view>
            <view class="info_1">
              <image src="/images/light_arrow.png" class="arrow_two"></image>
            </view>
            <view class="info_2">
              <view class="transfer_time">{{item.t2_time_end}}</view>
            </view>
          </view>

          <view class="four_stations">
            <view class = "station_item"><l-tag plain="{{false}}" size="mini">{{item.t1_station_start}}</l-tag></view>
            <view class = "station_item"><l-tag plain="{{true}}" size="mini">{{item.t1_station_end}}</l-tag></view>
            <view class = "station_item"><l-tag plain="{{true}}" size="mini">{{item.t2_station_start}}</l-tag></view>
            <view class = "station_item"><l-tag plain="{{false}}" size="mini">{{item.t2_station_end}}</l-tag></view>
          </view>

          <view class="date_and_price">
            <view class="three_info">
              <view class="date">{{item.t1_date}}出发</view>
            </view>
            <view class="three_info">
              <view class="total_time">总时长{{item.total_time}}</view>
            </view>
            <view class="three_info">
              <view class="price_transfer" wx:if="{{item.total_price != 0}}">￥{{item.total_price}}起</view>
              <view class="price_transfer" wx:else>暂无价格信息</view>
            </view>
          </view>
          
        </view>
      </block>
    </view>
    <view wx:else class="no_air">{{result_null_transfer}}</view>
  </l-tabpanel>

</l-tabs>